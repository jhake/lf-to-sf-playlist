(this["webpackJsonplf-to-sf-playlist"]=this["webpackJsonplf-to-sf-playlist"]||[]).push([[0],{115:function(t,e,a){"use strict";a.r(e);var r,n,c=a(1),o=a(0),s=a.n(o),l=a(18),i=a.n(l),u=(a(59),a(19)),d=a(3),b=a(4),p=(a(60),a(7)),j=a(117),h="token",f=function(){var t=Object(j.a)([h]),e=Object(p.a)(t,3),a=e[0],r=e[2];return{currentUser:a.token,logout:function(){r(h)}}},v=a(6),m=a.n(v),O=a(13),g=a(14),x=a.n(g),k=function(){var t=f(),e=t.currentUser,a=t.logout,r=function(){var t=Object(O.a)(m.a.mark((function t(){var e;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.a.delete("http://localhost:3002/logout",{timeout:2e3,withCredentials:!0});case 3:a(),b.b.success("Logged out successfully."),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),401===(null===(e=t.t0.response)||void 0===e?void 0:e.status)?(b.b.error("Please login again"),a()):b.b.error(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(u.b,{to:"/",children:"Home"}),e?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(u.b,{to:"/spotify-stats",children:"Spotify Stats"}),Object(c.jsx)(u.b,{to:"/lastfm-stats",children:"Lastfm Stats"}),Object(c.jsx)("button",{onClick:function(){r()},children:"Logout"})]}):""]})},y=a(21),w=function(t){var e=t.spotifyTrackIds,a=Object(y.a)(new Set(Object(y.a)(e)));return Object(c.jsx)(c.Fragment,{children:null===a||void 0===a?void 0:a.map((function(t){return Object(c.jsx)("iframe",{src:"https://open.spotify.com/embed/track/".concat(t),width:300,height:380,frameBorder:0,allowTransparency:!0,allow:"encrypted-media",style:{borderRadius:"10px"}},t)}))})},C=a(52),T=a.n(C),S=function(){var t,e=T.a.parse(Object(d.g)().search),a=e.limit,r=e.offset,n=e.time_range,s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,a=Object(o.useState)(),r=Object(p.a)(a,2),n=r[0],c=r[1],s=Object(o.useState)(!0),l=Object(p.a)(s,2),i=l[0],u=l[1],d=Object(o.useState)(),j=Object(p.a)(d,2),h=j[0],v=j[1],g=f().logout;return Object(o.useEffect)((function(){Object(O.a)(m.a.mark((function a(){var r,n;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,x.a.get(t,{timeout:e,withCredentials:!0});case 3:r=a.sent,c(r.data),u(!1),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),401===(null===(n=a.t0.response)||void 0===n?void 0:n.status)?(b.b.error("Please login again"),g()):(v(a.t0),u(!1));case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()}),[t]),{data:n,loading:i,error:h}}("http://localhost:3002/top_tracks?"+(a?"limit=".concat(a,"&"):"")+(r?"offset=".concat(r,"&"):"")+(n?"time_range=".concat(n,"&"):"")),l=s.data,i=s.loading,u=s.error;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h1",{children:"Spotify Stats"}),i?"loading":Object(c.jsx)(w,{spotifyTrackIds:null!==(t=null===l||void 0===l?void 0:l.map((function(t){return t.id})))&&void 0!==t?t:[]}),u&&"errors occured"]})},L=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{spotifyTrackIds:[]},e=t.spotifyTrackIds,a=f(),r=a.logout,n=function(){var t=Object(O.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"http://localhost:3002/create_playlist",a={name:prompt("Enter name","New Playlist"),tracks:e.map((function(t){return"spotify:track:".concat(t)}))},t.prev=2,t.next=5,x.a.post("http://localhost:3002/create_playlist",a,{timeout:2e3,withCredentials:!0});case 5:b.b.success("Playlist created!"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),401===(null===(n=t.t0.response)||void 0===n?void 0:n.status)?(b.b.error("Please login again"),r()):b.b.error(t.t0.response?t.t0.response.data.error:t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(){return t.apply(this,arguments)}}();return Object(c.jsx)("button",{onClick:n,children:"Create Playlist"})};!function(t){t.topTracks="user.getTopTracks",t.weeklyTrackChart="user.getWeeklyTrackChart"}(r||(r={})),function(t){t.overall="overall",t.week="7day",t.month="1month",t.quarter="3month",t.half="6month",t.year="12month"}(n||(n={}));var P=a(24),F=a(35),_=a(53),D=(a(103),a(104),[{label:"Top Tracks",value:r.topTracks},{label:"Specific Time Period",value:r.weeklyTrackChart}]),I=[{label:"Overall",value:n.overall},{label:"Last 7 days",value:n.week},{label:"Last month",value:n.month},{label:"Last 3 months",value:n.quarter},{label:"Last 6 months",value:n.half},{label:"Last year",value:n.year}],E=function(t){var e=t.lfParams,a=t.setLfParams,n=Object(o.useState)({startDate:new Date,endDate:new Date}),s=Object(p.a)(n,2),l=s[0],i=s[1],u=function(t){var r=Object(P.a)({},e);"user"===t.target.id?r[t.target.id]=t.target.value:"limit"!==t.target.id&&"page"!==t.target.id||(r[t.target.id]=Number(t.target.value)),a(r)};return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(F.a,{options:D,placeholder:"method",onChange:function(t){var r=t.value,n=Object(P.a)({},e);n.method=r,a(n)},value:D.find((function(t){return t.value===e.method}))}),e.method===r.topTracks?Object(c.jsx)(F.a,{options:I,placeholder:"period",onChange:function(t){var r=t.value,n=Object(P.a)({},e);n.period=r,a(n)},value:I.find((function(t){return t.value===e.period}))}):"",e.method===r.weeklyTrackChart?Object(c.jsx)(_.DateRangePicker,{ranges:[l],onChange:function(t){i(t.range1);var r=Object(P.a)({},e);r.from=Math.floor(t.range1.startDate/1e3),r.to=Math.floor(t.range1.endDate/1e3),a(r)}}):"",Object(c.jsx)("input",{id:"user",type:"text",placeholder:"lastfm username",onChange:u,value:e.user}),Object(c.jsx)("input",{id:"limit",type:"number",placeholder:"limit",onChange:u,value:e.limit})]})},M=function(){var t,e,a,s,l,i=f().logout,u=Object(o.useState)({method:r.topTracks,user:"",period:n.overall,limit:100,page:1}),d=Object(p.a)(u,2),j=d[0],h=d[1],v=Object(o.useState)(),g=Object(p.a)(v,2),k=g[0],C=g[1],T=Object(o.useState)([]),S=Object(p.a)(T,2),P=S[0],F=S[1],_=Object(o.useState)(!1),D=Object(p.a)(_,2),I=D[0],M=D[1],q=Object(o.useState)(0),B=Object(p.a)(q,2),U=B[0],A=B[1],H=null!==(t=(null===j||void 0===j?void 0:j.method)===r.topTracks?null===k||void 0===k||null===(e=k.toptracks)||void 0===e?void 0:e.track:null===k||void 0===k||null===(a=k.weeklytrackchart)||void 0===a?void 0:a.track)&&void 0!==t?t:[],J=function(){var t=Object(O.a)(m.a.mark((function t(){var e,a,r,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a in e="http://localhost:3002/lf_get_request?",j)console.log(j[a]),e+="".concat(a,"=").concat(j[a],"&");return t.prev=2,t.next=5,x.a.get(e,{withCredentials:!0});case 5:r=t.sent,C(r.data),A(0),F([]),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),401===(null===(n=t.t0.response)||void 0===n?void 0:n.status)?(b.b.error("Please login again"),i()):b.b.error("An error occured when loading the lf tracks");case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(){return t.apply(this,arguments)}}();console.log({loadCount:U});var N=function(){var t=Object(O.a)(m.a.mark((function t(){var e,a,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"http://localhost:3002/search_spotify_tracks?",e=H.slice(U,U+10).map((function(t){return"".concat(t.name," ").concat(t.artist.name||t.artist["#text"])})),console.log(e),M(!0),t.prev=4,t.next=7,x.a.get("http://localhost:3002/search_spotify_tracks?",{timeout:5e4,params:{queries:e},withCredentials:!0});case 7:a=t.sent,F([].concat(Object(y.a)(P),Object(y.a)(a.data))),A(U+10),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),401===(null===(r=t.t0.response)||void 0===r?void 0:r.status)?(b.b.error("Please login again"),i()):b.b.error(t.t0.message);case 15:M(!1);case 16:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(){return t.apply(this,arguments)}}();return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h1",{children:"LastFM stats"}),Object(c.jsx)("button",{onClick:J,children:"LastFM Search"}),Object(c.jsx)(E,{lfParams:j,setLfParams:h}),Object(c.jsx)(L,{spotifyTrackIds:null!==(s=null===P||void 0===P?void 0:P.map((function(t){return null===t||void 0===t?void 0:t.id})))&&void 0!==s?s:[]}),Object(c.jsx)("br",{}),Object(c.jsx)(w,{spotifyTrackIds:null!==(l=null===P||void 0===P?void 0:P.map((function(t){return null===t||void 0===t?void 0:t.id})))&&void 0!==l?l:[]}),Object(c.jsx)("br",{}),I?"Loading":U<H.length?Object(c.jsx)("button",{onClick:N,children:"Load more"}):""]})};var q=function(){var t=f().currentUser;return Object(o.useEffect)((function(){t&&b.b.success("Successfully logged in!")}),[t]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(u.a,{children:Object(c.jsx)(d.d,{children:t?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(k,{}),Object(c.jsx)(d.b,{exact:!0,path:"/",component:function(){return Object(c.jsx)("h1",{children:"HOMEPAGE"})}}),Object(c.jsx)(d.b,{exact:!0,path:"/spotify-stats",component:S}),Object(c.jsx)(d.b,{exact:!0,path:"/lastfm-stats",component:M})]}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(d.b,{exact:!0,path:"/",component:function(){return Object(c.jsx)("a",{href:"http://localhost:3002/auth/spotify",children:"Login with Spotify"})}}),Object(c.jsx)(d.a,{to:"/"})]})})}),Object(c.jsx)(b.a,{})]})},B=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,118)).then((function(e){var a=e.getCLS,r=e.getFID,n=e.getFCP,c=e.getLCP,o=e.getTTFB;a(t),r(t),n(t),c(t),o(t)}))};i.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(q,{})}),document.getElementById("root")),B()},59:function(t,e,a){}},[[115,1,2]]]);
//# sourceMappingURL=main.c6bdfdb2.chunk.js.map